<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!--
  AZURE DEPLOYMENT MANIFEST
  =========================
  Use this manifest when deploying to Azure:
  - Frontend: Azure Storage Static Website (netsuiteexcelweb)
  - Backend: Azure Container Apps (netsuite-flask)
  
  Resource Group: netsuite-excel-func-rg
  
  URLs:
  - Frontend: https://netsuiteexcelweb.z13.web.core.windows.net
  - Backend: https://netsuite-flask.ashymeadow-6282430c.eastus.azurecontainerapps.io
-->
<OfficeApp 
  xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" 
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
  xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"
  xmlns:ov="http://schemas.microsoft.com/office/taskpaneappversionoverrides"
  xsi:type="TaskPaneApp">

  <Id>a1b2c3d4-5678-90ab-cdef-123456789abc</Id>
  <Version>3.0.5.139</Version>
  <ProviderName>CloudExtend</ProviderName>
  <DefaultLocale>en-US</DefaultLocale>
  <DisplayName DefaultValue="XAVI for NetSuite (Azure)"/>
  <Description DefaultValue="XAVI - Financial reporting formulas for NetSuite - Azure Deployment"/>
  <IconUrl DefaultValue="https://netsuiteexcelweb.z13.web.core.windows.net/icon-32.png?v=3.0.5.139"/>
  <HighResolutionIconUrl DefaultValue="https://netsuiteexcelweb.z13.web.core.windows.net/icon-64.png?v=3.0.5.139"/>
  <SupportUrl DefaultValue="https://www.cloudextend.io"/>

  <Hosts>
    <Host Name="Workbook"/>
  </Hosts>

  <!-- Requirements for Custom Functions -->
  <Requirements>
    <Sets DefaultMinVersion="1.1">
      <Set Name="CustomFunctionsRuntime" MinVersion="1.1"/>
    </Sets>
  </Requirements>

  <!-- Task Pane -->
  <DefaultSettings>
    <SourceLocation DefaultValue="https://netsuiteexcelweb.z13.web.core.windows.net/taskpane.html?v=3.0.5.139&amp;mode=azure"/>
  </DefaultSettings>

  <Permissions>ReadWriteDocument</Permissions>

  <VersionOverrides xmlns="http://schemas.microsoft.com/office/taskpaneappversionoverrides"
                    xsi:type="VersionOverridesV1_0">

    <Hosts>
      <Host xsi:type="Workbook">

        <!-- Enable Shared Runtime for communication between taskpane and custom functions -->
        <Runtimes>
          <Runtime resid="Functions.Page.Url" lifetime="long"/>
        </Runtimes>

        <!-- Custom Functions (valid under AllFormFactors) -->
        <AllFormFactors>
          <ExtensionPoint xsi:type="CustomFunctions">
            <Script>
              <SourceLocation resid="Functions.Script.Url"/>
            </Script>
            <Page>
              <SourceLocation resid="Functions.Page.Url"/>
            </Page>
            <Metadata>
              <SourceLocation resid="Functions.Metadata.Url"/>
            </Metadata>
            <Namespace resid="Functions.Namespace"/>
          </ExtensionPoint>
        </AllFormFactors>

        <!-- Desktop UI (Ribbon + Context Menu) -->
        <DesktopFormFactor>
          <!-- FunctionFile uses Taskpane for shared runtime (no separate window) -->
          <FunctionFile resid="Taskpane.Url"/>

          <!-- Ribbon Button on DATA Tab -->
          <ExtensionPoint xsi:type="PrimaryCommandSurface">
            <OfficeTab id="TabData">
              <Group id="CloudExtend.Group">
                <Label resid="CloudExtend.Group.Label"/>

                <Icon>
                  <bt:Image size="16" resid="Icon.16x16"/>
                  <bt:Image size="32" resid="Icon.32x32"/>
                  <bt:Image size="80" resid="Icon.80x80"/>
                </Icon>

                <Control xsi:type="Button" id="CloudExtend.TaskpaneButton">
                  <Label resid="Taskpane.Button.Label"/>
                  <Supertip>
                    <Title resid="Taskpane.Button.Label"/>
                    <Description resid="Taskpane.Button.Description"/>
                  </Supertip>
                  <Icon>
                    <bt:Image size="16" resid="Icon.16x16"/>
                    <bt:Image size="32" resid="Icon.32x32"/>
                    <bt:Image size="80" resid="Icon.80x80"/>
                  </Icon>
                  <Action xsi:type="ShowTaskpane">
                    <TaskpaneId>CloudExtend.Taskpane</TaskpaneId>
                    <SourceLocation resid="Taskpane.Url"/>
                  </Action>
                </Control>

              </Group>
            </OfficeTab>
          </ExtensionPoint>

          <!-- Context Menu -->
          <ExtensionPoint xsi:type="ContextMenu">
            <OfficeMenu id="ContextMenuCell">

              <Control xsi:type="Menu" id="CloudExtend.ContextMenu">
                <Label resid="ContextMenu.Label"/>
                <Supertip>
                  <Title resid="ContextMenu.Label"/>
                  <Description resid="ContextMenu.Description"/>
                </Supertip>
                <Icon>
                  <bt:Image size="16" resid="Icon.16x16"/>
                  <bt:Image size="32" resid="Icon.32x32"/>
                  <bt:Image size="80" resid="Icon.80x80"/>
                </Icon>

                <Items>
                  <Item id="CloudExtend.DrillDown">
                    <Label resid="DrillDown.Label"/>
                    <Supertip>
                      <Title resid="DrillDown.Label"/>
                      <Description resid="DrillDown.Description"/>
                    </Supertip>
                    <Icon>
                      <bt:Image size="16" resid="Icon.16x16"/>
                      <bt:Image size="32" resid="Icon.32x32"/>
                      <bt:Image size="80" resid="Icon.80x80"/>
                    </Icon>

                    <Action xsi:type="ExecuteFunction">
                      <FunctionName>drillDownFromContextMenu</FunctionName>
                    </Action>

                  </Item>
                </Items>

              </Control>

            </OfficeMenu>
          </ExtensionPoint>

        </DesktopFormFactor>

      </Host>
    </Hosts>

    <Resources>

      <!-- Icons - Azure Storage -->
      <bt:Images>
        <bt:Image id="Icon.16x16" DefaultValue="https://netsuiteexcelweb.z13.web.core.windows.net/icon-16.png?v=3.0.5.139"/>
        <bt:Image id="Icon.32x32" DefaultValue="https://netsuiteexcelweb.z13.web.core.windows.net/icon-32.png?v=3.0.5.139"/>
        <bt:Image id="Icon.80x80" DefaultValue="https://netsuiteexcelweb.z13.web.core.windows.net/icon-80.png?v=3.0.5.139"/>
      </bt:Images>

      <!-- External Files - Azure Storage -->
      <bt:Urls>
        <bt:Url id="Commands.Url" DefaultValue="https://netsuiteexcelweb.z13.web.core.windows.net/commands.html?v=3.0.5.139"/>
        <bt:Url id="Taskpane.Url" DefaultValue="https://netsuiteexcelweb.z13.web.core.windows.net/taskpane.html?v=3.0.5.139&amp;mode=azure"/>
        <bt:Url id="Functions.Script.Url" DefaultValue="https://netsuiteexcelweb.z13.web.core.windows.net/functions.js?v=3.0.5.139"/>
        <bt:Url id="Functions.Metadata.Url" DefaultValue="https://netsuiteexcelweb.z13.web.core.windows.net/functions.json?v=3.0.5.139"/>
        <bt:Url id="Functions.Page.Url" DefaultValue="https://netsuiteexcelweb.z13.web.core.windows.net/functions.html?v=3.0.5.139"/>
      </bt:Urls>

      <!-- Strings -->
      <bt:ShortStrings>
        <bt:String id="Functions.Namespace" DefaultValue="XAVI"/>
        <bt:String id="CloudExtend.Group.Label" DefaultValue="CloudExtend"/>
        <bt:String id="Taskpane.Button.Label" DefaultValue="XAVI"/>
        <bt:String id="ContextMenu.Label" DefaultValue="NetSuite"/>
        <bt:String id="DrillDown.Label" DefaultValue="View Transactions"/>
      </bt:ShortStrings>

      <bt:LongStrings>
        <bt:String id="Taskpane.Button.Description" DefaultValue="Open the CloudExtend task pane for NetSuite formulas (Azure)"/>
        <bt:String id="ContextMenu.Description" DefaultValue="NetSuite formula tools"/>
        <bt:String id="DrillDown.Description" DefaultValue="View underlying transactions for this balance"/>
      </bt:LongStrings>

    </Resources>

  </VersionOverrides>

</OfficeApp>

