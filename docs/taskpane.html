<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NetSuite Excel Formulas</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            padding: 0;
            height: 100vh;
            overflow-y: auto;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            box-shadow: 0 0 40px rgba(0,0,0,0.1);
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.95;
        }

        .content {
            padding: 30px 20px;
        }

        .status-badge {
            display: inline-block;
            background: #10b981;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .refresh-section {
            background: #fef3c7;
            border: 2px solid #fbbf24;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .refresh-section h2 {
            font-size: 16px;
            color: #92400e;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .refresh-section p {
            font-size: 13px;
            color: #78350f;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .refresh-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-bottom: 10px;
        }

        .refresh-btn:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .refresh-btn:active {
            transform: translateY(0);
        }

        .refresh-status {
            font-size: 12px;
            color: #059669;
            text-align: center;
            margin-top: 10px;
            min-height: 20px;
        }

        .formula-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .formula-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .formula-name {
            font-size: 18px;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 8px;
            font-family: 'Monaco', 'Courier New', monospace;
        }

        .formula-description {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .formula-syntax {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 12px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 12px;
            color: #334155;
            margin-bottom: 12px;
            overflow-x: auto;
        }

        .parameters {
            margin-top: 12px;
        }

        .param-title {
            font-size: 12px;
            font-weight: 600;
            color: #475569;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .param-item {
            font-size: 13px;
            color: #64748b;
            margin-bottom: 6px;
            padding-left: 12px;
            line-height: 1.5;
        }

        .param-name {
            font-weight: 600;
            color: #334155;
            font-family: 'Monaco', 'Courier New', monospace;
        }

        .example {
            background: #f1f5f9;
            border-left: 3px solid #667eea;
            padding: 12px;
            margin-top: 12px;
            border-radius: 4px;
        }

        .example-title {
            font-size: 11px;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .example-code {
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 12px;
            color: #334155;
        }

        .footer {
            background: #f8fafc;
            padding: 20px;
            text-align: center;
            border-top: 1px solid #e2e8f0;
            margin-top: 30px;
        }

        .footer p {
            font-size: 12px;
            color: #64748b;
        }

        .footer a {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        .info-box {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 25px;
        }

        .info-box p {
            font-size: 13px;
            color: #1e40af;
            line-height: 1.6;
        }

        .info-box strong {
            color: #1e3a8a;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>NetSuite Excel Formulas</h1>
            <p>Real-time NetSuite data in your spreadsheets</p>
        </div>

        <div class="content">
            <div class="status-badge">âœ“ Connected to NetSuite</div>

            <!-- REFRESH SECTION -->
            <div class="refresh-section">
                <h2>ðŸ”„ Refresh NetSuite Data</h2>
                <p>Get the latest data from NetSuite by clicking the button below. This will recalculate all NetSuite formulas in your workbook.</p>
                <button class="refresh-btn" onclick="refreshAllFormulas()">Refresh All Data</button>
                <div class="refresh-status" id="refreshStatus"></div>
            </div>

            <div class="info-box">
                <p><strong>Getting Started:</strong> Use the formulas below in any Excel cell. They will automatically query your NetSuite data in real-time. All formulas accept both numeric and text account numbers.</p>
            </div>

            <!-- NS.GLATITLE -->
            <div class="formula-card">
                <div class="formula-name">NS.GLATITLE</div>
                <div class="formula-description">
                    Get the account name for any NetSuite account number or ID.
                </div>
                <div class="formula-syntax">
                    =NS.GLATITLE(accountNumber)
                </div>
                <div class="parameters">
                    <div class="param-title">Parameters</div>
                    <div class="param-item">
                        <span class="param-name">accountNumber</span> - Account number or internal ID (numeric or text)
                    </div>
                </div>
                <div class="example">
                    <div class="example-title">Examples</div>
                    <div class="example-code">=NS.GLATITLE(A4)</div>
                    <div class="example-code">=NS.GLATITLE("4010")</div>
                    <div class="example-code">=NS.GLATITLE(1100)</div>
                </div>
            </div>

            <!-- NS.GLABAL -->
            <div class="formula-card">
                <div class="formula-name">NS.GLABAL</div>
                <div class="formula-description">
                    Get the GL account balance for a specific period or range, with optional filtering by subsidiary, department, location, and class.
                </div>
                <div class="formula-syntax">
                    =NS.GLABAL(account, fromPeriod, toPeriod, [subsidiary], [department], [location], [class])
                </div>
                <div class="parameters">
                    <div class="param-title">Required Parameters</div>
                    <div class="param-item">
                        <span class="param-name">account</span> - Account number or ID
                    </div>
                    <div class="param-item">
                        <span class="param-name">fromPeriod</span> - Starting period (e.g., "Jan 2025")
                    </div>
                    <div class="param-item">
                        <span class="param-name">toPeriod</span> - Ending period (e.g., "Dec 2025")
                    </div>
                    <div class="param-title" style="margin-top: 15px;">Optional Parameters</div>
                    <div class="param-item">
                        <span class="param-name">subsidiary</span> - Filter by subsidiary ID
                    </div>
                    <div class="param-item">
                        <span class="param-name">department</span> - Filter by department ID
                    </div>
                    <div class="param-item">
                        <span class="param-name">location</span> - Filter by location ID
                    </div>
                    <div class="param-item">
                        <span class="param-name">class</span> - Filter by class ID
                    </div>
                </div>
                <div class="example">
                    <div class="example-title">Examples</div>
                    <div class="example-code">=NS.GLABAL("4010", "Jan 2025", "Dec 2025")</div>
                    <div class="example-code">=NS.GLABAL(A4, B1, C1)</div>
                    <div class="example-code">=NS.GLABAL("4010", "Jan 2025", "Jan 2025", "", "13", "", "")</div>
                </div>
            </div>

            <!-- NS.GLABUD -->
            <div class="formula-card">
                <div class="formula-name">NS.GLABUD</div>
                <div class="formula-description">
                    Get the budget amount for an account and period, with optional filtering by subsidiary, department, location, and class.
                </div>
                <div class="formula-syntax">
                    =NS.GLABUD(account, fromPeriod, toPeriod, [subsidiary], [department], [location], [class])
                </div>
                <div class="parameters">
                    <div class="param-title">Required Parameters</div>
                    <div class="param-item">
                        <span class="param-name">account</span> - Account number or ID
                    </div>
                    <div class="param-item">
                        <span class="param-name">fromPeriod</span> - Starting period (e.g., "Jan 2025")
                    </div>
                    <div class="param-item">
                        <span class="param-name">toPeriod</span> - Ending period (e.g., "Dec 2025")
                    </div>
                    <div class="param-title" style="margin-top: 15px;">Optional Parameters</div>
                    <div class="param-item">
                        <span class="param-name">subsidiary</span> - Filter by subsidiary ID
                    </div>
                    <div class="param-item">
                        <span class="param-name">department</span> - Filter by department ID
                    </div>
                    <div class="param-item">
                        <span class="param-name">location</span> - Filter by location ID
                    </div>
                    <div class="param-item">
                        <span class="param-name">class</span> - Filter by class ID
                    </div>
                </div>
                <div class="example">
                    <div class="example-title">Examples</div>
                    <div class="example-code">=NS.GLABUD("5000", "Jan 2025", "Dec 2025")</div>
                    <div class="example-code">=NS.GLABUD(A4, B1, C1)</div>
                </div>
            </div>

            <div class="info-box" style="background: #fef3c7; border-color: #fde68a;">
                <p style="color: #92400e;"><strong>ðŸ’¡ Pro Tip:</strong> Use TEXT() to format date cells: <code>=NS.GLABAL("4010", TEXT(C3,"mmm yyyy"), TEXT(D3,"mmm yyyy"))</code></p>
            </div>
        </div>

        <div class="footer">
            <p>NetSuite Excel Add-in by <a href="https://www.cloudextend.io" target="_blank">CloudExtend</a></p>
            <p style="margin-top: 8px; font-size: 11px;">For support, visit <a href="https://www.cloudextend.io" target="_blank">cloudextend.io</a></p>
        </div>
    </div>

    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script>
        Office.onReady((info) => {
            console.log('NetSuite Excel Add-in task pane loaded');
        });

        async function refreshAllFormulas() {
            const statusEl = document.getElementById('refreshStatus');
            const btn = event.target;
            
            try {
                btn.disabled = true;
                btn.textContent = 'Refreshing...';
                statusEl.textContent = 'Recalculating all formulas...';
                statusEl.style.color = '#0284c7';
                
                await Excel.run(async (context) => {
                    // Get all worksheets
                    const sheets = context.workbook.worksheets;
                    sheets.load('items');
                    await context.sync();
                    
                    // Recalculate each sheet
                    for (let i = 0; i < sheets.items.length; i++) {
                        sheets.items[i].calculate(false);
                    }
                    
                    await context.sync();
                    
                    statusEl.textContent = 'âœ“ All formulas refreshed with latest NetSuite data!';
                    statusEl.style.color = '#059669';
                    
                    setTimeout(() => {
                        statusEl.textContent = '';
                    }, 3000);
                });
                
            } catch (error) {
                console.error('Error refreshing formulas:', error);
                statusEl.textContent = 'âœ— Error refreshing. Please try again.';
                statusEl.style.color = '#dc2626';
                
                setTimeout(() => {
                    statusEl.textContent = '';
                }, 3000);
            } finally {
                btn.disabled = false;
                btn.textContent = 'Refresh All Data';
            }
        }
    </script>
</body>
</html>
